Split class into separate concerns
